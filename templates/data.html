<html>

<head>
    <meta charset="UTF-8">
    <link href="../static/img/favicon.ico" rel="icon">
    <link href="../static/css/bootstrap.css" rel="stylesheet" media="all">
    <link href="../static/css/main.css" rel="stylesheet" media="all">
    <script src="../static/js/jquery-3.4.1.js"></script>
    <script src="../static/js/bootstrap.bundle.js"></script>
    <script src="../static/js/echarts-en.js"></script>
    <title>Data Visualization</title>
</head>

<body>
    <div class="h-100 w-100 row m-0 p-0">
        {% include 'nav.html' %}
        <div class="lb p-0 col-9">
            {% include 'header.html' %}
            <div class="pt-3 mx-0 overflow-auto" style="height:90vh">
                <h2 class="text-center"><strong>Data Visualization</strong></h2>
                <div class="row m-0 p-0 align-items-center" style="background-color: rgba(255, 255, 255, 1);">
                    <!-- <div class="col-6" style="height:50vh;" id="fig_1_1">text</div>
                    <div class="col-6" style="height:50vh;" id="fig_1_2">text</div> -->
                    <div class="text-center mt-3">
                        <img src="../static/img/fig_1.png" width="41%">
                        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                        <img src="../static/img/fig_2.png" width="35%">
                    </div>
                    {% csrf_token %}
                    <form class="row form-inline mt-3 w-100" role="form" action="../data_html/" method="GET"
                        enctype=application/x-www-form-urlencoded>
                        <div class="col-6 pl-5"><b>Top <input name="params1" type="text" class="p-1 mx-1 form-control"
                                style="width:3.5vw" value={{ params1 }}></intput> of proteins with compounds</b>
                            <button type="submit" class="btn btn-primary ml-2"><strong>Submit</strong></button>
                            <br><i><span style="color:gray">Please fill in an integer between 1-1214</span></i>
                        </div>
                        <div class="col-6 pl-5"><b>Top <input name="params2" type="text" class="p-1 mx-1 form-control"
                                style="width:3.5vw" value={{ params2 }}></intput> of proteins with structures</b>
                            <button type="submit" class="btn btn-primary ml-1"><strong>Submit</strong></button>
                            <br><i><span style="color:gray">Please fill in an integer between 1-1214</span></i>
                        </div>
                    </form>
                    <div class="col-6" id="fig_2_1">text</div>
                    <div class="col-6" id="fig_2_2">text</div>
                </div>
            </div>
        </div>
    </div>

    <script>
        data_2_1 = {{ data_2_1 | safe }};
        data_2_2 = {{ data_2_2 | safe }};
        h1 = Math.max(50, data_2_1.length / 4)
        h2 = Math.max(50, data_2_2.length / 4)
        $("#fig_2_1").height(h1 + 'vh');
        $("#fig_2_2").height(h2 + 'vh');
    </script>
<!-- 
    <script type="text/javascript">
        // 基于准备好的dom，初始化echarts实例
        var myChart = echarts.init(document.getElementById('fig_1_1'));

        // 指定图表的配置项和数据
        var option = {
            title: {
                text: 'Statistics and confidence levels \nof MC-related proteins'
            },
            tooltip: {},
            xAxis: {
                data: ["★★★★", "★★★", "★★", "★"]
            },
            yAxis: {
                name: 'Number of occurrences',
                nameLocation: 'middle',
                nameGap: 40
            },

            series: [{
                type: 'bar',
                data: [{
                    'name': 'level1',
                    'value': 93,
                    'url': '../gene_search/?text=level1&page=1'
                }, {
                    'name': 'level2',
                    'value': 93,
                    'url': '../gene_search/?text=level2&page=1'
                }, {
                    'name': 'level3',
                    'value': 106,
                    'url': '../gene_search/?text=level3&page=1'
                }, {
                    'name': 'level4',
                    'value': 927,
                    'url': '../gene_search/?text=level4&page=1'
                }],
                label: {
                    show: true,
                    position: 'top',
                    formatter: '{c}',
                    distance: 5
                },
                barWidth: "40%",
                showBackground: false,
                backgroundStyle: {
                    color: 'rgba(220, 220, 220, 1)'
                },
                itemStyle: {
                    barBorderRadius: [5, 5, 0, 0],// 圆角（左上、右上、右下、左下） 
                    shadowColor: 'rgba(0, 0, 0, 0.5)',
                    shadowBlur: 10,
                    shadowOffsetX: 2,
                    shadowOffsetY: 2,
                    color: new echarts.graphic.LinearGradient(
                        0, 0, 0, 1,
                        [
                            { offset: 0, color: '#83bff6' },
                            { offset: 1, color: '#188df0' }
                        ]
                    )
                },
                emphasis: {
                    itemStyle: {
                        show: true,
                        barBorderRadius: [5, 5, 0, 0],// 圆角（左上、右上、右下、左下） 
                        shadowColor: 'rgba(0, 0, 0, 0.5)',
                        shadowBlur: 12,
                        shadowOffsetX: 2,
                        shadowOffsetY: 2,
                        color: new echarts.graphic.LinearGradient(
                            0, 0, 0, 1,
                            [
                                { offset: 0, color: '#83bff6' },
                                { offset: 0.7, color: '#188df0' },
                                { offset: 1, color: '#188df0' }
                            ]
                        )
                    }
                },
            }]
        };

        // 使用刚指定的配置项和数据显示图表。
        myChart.setOption(option);
        myChart.on('click', function (param) {
            var url = param.data.url;
            // console.log(param);
            window.location.href = url;
        });        
    </script>

    <script type="text/javascript">
        // 基于准备好的dom，初始化echarts实例
        var myChart = echarts.init(document.getElementById('fig_1_2'));

        // 指定图表的配置项和数据
        var option = {
            title: {
                text: 'Statistics and classification of\nmitotic related chemical intervention agents',
                left: '10%'
            },
            tooltip: {},
            xAxis: {
                data: ["Inhibitor", "Activator", "Allosteric regular"]
            },
            yAxis: {
                name: 'Number of occurrences',
                nameLocation: 'middle',
                nameGap: 40
            },

            series: [{
                type: 'bar',
                data: [{
                    'name': 'Inhibitor',
                    'value': 4630,
                    'url': '../compound_search/?text=inhibitor&page=1'
                }, {
                    'name': 'Activator',
                    'value': 319,
                    'url': '../compound_search/?text=activator&page=1'
                }, {
                    'name': 'Allosteric regulator',
                    'value': 65,
                    'url': '../compound_search/?text=allosteric regulator&page=1'
                }],
                label: {
                    show: true,
                    position: 'top',
                    formatter: '{c}',
                    distance: 5
                },
                barWidth: "40%",
                showBackground: false,
                backgroundStyle: {
                    color: 'rgba(220, 220, 220, 1)'
                },
                itemStyle: {
                    barBorderRadius: [5, 5, 0, 0],// 圆角（左上、右上、右下、左下） 
                    shadowColor: 'rgba(0, 0, 0, 0.5)',
                    shadowBlur: 10,
                    shadowOffsetX: 2,
                    shadowOffsetY: 2,
                    color: new echarts.graphic.LinearGradient(
                        0, 0, 0, 1,
                        [
                            { offset: 0, color: '#83bff6' },
                            { offset: 1, color: '#188df0' }
                        ]
                    )
                },
                emphasis: {
                    itemStyle: {
                        show: true,
                        barBorderRadius: [5, 5, 0, 0],// 圆角（左上、右上、右下、左下） 
                        shadowColor: 'rgba(0, 0, 0, 0.5)',
                        shadowBlur: 12,
                        shadowOffsetX: 2,
                        shadowOffsetY: 2,
                        color: new echarts.graphic.LinearGradient(
                            0, 0, 0, 1,
                            [
                                { offset: 0, color: '#83bff6' },
                                { offset: 0.7, color: '#188df0' },
                                { offset: 1, color: '#188df0' }
                            ]
                        )
                    }
                },
            }]
        };


        // 使用刚指定的配置项和数据显示图表。
        myChart.setOption(option);
        myChart.on('click', function (param) {
            var url = param.data.url;
            // console.log(param);
            window.location.href = url;
        });         
    </script> -->

    <script>
        var myChart = echarts.init(document.getElementById('fig_2_1'));
        colors = ['', 'red',
            'blue',
            'green',
            'orange']
        option = {
            // title: {
            //     text: 'Top 30 proteins with chemical intervention agents',
            //     left: '0%'
            // },
            grid: {
                show: true,
                borderColor: 'black',
                borderWidth: 1,
                left: 50,
                top: 20,
                right: 90,
                z: 10
            },
            xAxis: {
                type: 'category',
                splitLine: {
                    lineStyle: {
                        type: 'dashed'
                    }
                },
                // name:'Gene Name',
                // nameLocation: 'center',
                // nameGap:'62',
                // nameTextStyle:{
                //     fontSize:15
                // },
                show: false,
                scale: false
            },
            yAxis: {
                splitLine: {
                    show: true,
                    lineStyle: {
                        type: 'dashed'
                    }
                },
                name: 'Ratio_c',
                nameLocation: 'center',
                nameGap: '25',
                nameTextStyle: {
                    fontSize: 15
                },
                scale: true
            },
            series: [{
                z: 20,
                data: {{ data_2_1| safe }},
        type: 'scatter',
            symbolSize: function (data) {
                return Math.sqrt(data[2]);
            },
        emphasis: {
            label: {
                show: true,
                    formatter: params => {
                        return params.data[0] + '\n' + params.data[2]+' compounds'
                    },
                        position: 'right',
                            backgroundColor: 'rgba(255, 255, 255, 0.8)',
                                padding: 3
            }
        },

        itemStyle: {
            shadowBlur: 10,
                shadowColor: 'rgba(120, 36, 50, 0.5)',
                    shadowOffsetY: 5
        }
                }],

        visualMap: [
            {
                type: 'piecewise',
                left: 'right',
                top: '10%',
                min: 1,
                max: 4,
                categories: [4, 3, 2, 1],
                text: ['Confidence\nLevel'],
                showLabel: true,
                splitNumber: 4,
                dimension: 3,
                inRange: {
                    color: ['green', 'blue', 'orange', 'red']
                },
                outOfRange: {
                    color: 'gray',
                    symbolSize: 3
                }
            }
        ]
            };
        myChart.setOption(option);
    </script>

    <script>
        var myChart = echarts.init(document.getElementById('fig_2_2'));
        colors = ['', 'red',
            'blue',
            'green',
            'orange']
        option = {
            // title: {
            //     text: 'Top 30 proteins with chemical intervention agents',
            //     left: '0%'
            // },
            grid: {
                show: true,
                borderColor: 'black',
                borderWidth: 1,
                left: 50,
                top: 20,
                right: 90,
                z: 10
            },
            xAxis: {
                // name:'Gene Name',
                // nameLocation: 'center',
                // nameGap:62,
                // nameTextStyle:{
                //     fontSize:15
                // },
                show: false,
                type: 'category',
                splitLine: {
                    lineStyle: {
                        type: 'dashed'
                    }
                },
                scale: true
            },
            yAxis: {
                splitLine: {
                    lineStyle: {
                        type: 'dashed'
                    }
                },
                name: 'Ratio_s',
                nameLocation: 'center',
                nameGap: '25',
                nameTextStyle: {
                    fontSize: 15
                },
                scale: true
            },
            series: [{
                z: 20,
                data: {{ data_2_2| safe }},
        type: 'scatter',
            symbolSize: function (data) {
                return Math.sqrt(data[2]);
            },
        emphasis: {
            label: {
                show: true,
                    formatter: params => {
                        return params.data[0] + '\n' + params.data[2]+' structures'
                    },
                        position: 'right',
                            backgroundColor: 'rgba(255, 255, 255, 0.8)',
                                padding: 3
            }
        },
        itemStyle: {
            shadowBlur: 10,
                shadowColor: 'rgba(120, 36, 50, 0.5)',
                    shadowOffsetY: 5
        }
            }],
        visualMap: [
            {
                type: 'piecewise',
                left: 'right',
                top: '10%',
                min: 1,
                max: 4,
                categories: [4, 3, 2, 1],
                text: ['Confidence\nLevel'],
                showLabel: true,
                splitNumber: 4,
                dimension: 3,
                inRange: {
                    color: ['green', 'blue', 'orange', 'red']
                },
                outOfRange: {
                    color: 'gray',
                    symbolSize: 3
                }
            }
        ]
        };
        myChart.setOption(option);
    </script>

    <!-- <script>
        $("#btn1").click(function () {
            alert($("#text1").attr('value'));
            $(window).attr('location', '../data_html/?params1=' + $("#text1").attr('value') + '&params2={{params2}}');
        })
    </script> -->



</body>

</html>